<div *ngIf="canCreateObra; else noPermission">
  <div class="form-container">
    <div class="form-header">
      <h1>Criar Nova Obra</h1>
    </div>
    <form [formGroup]="obraForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="nome"><img src="img/redIcons/nameIconRed.svg" alt="Nome"> Nome da Obra</label>
        <input id="nome" formControlName="nome" placeholder="Nome da Obra">
      </div>
      <div class="form-group">
        <label for="localizacao"><img src="img/localIcon.svg" alt="Localização"> Localização</label>
        <input id="localizacao" formControlName="localizacao" placeholder="Localização">
      </div>
      <div class="form-group">
        <label for="contratante"><img src="img/redIcons/contractIconRed.svg" alt="Contratante"> Contratante</label>
        <input id="contratante" formControlName="contratante" placeholder="Contratante">
      </div>
      <div class="form-group">
        <label for="contrato"><img src="img/redIcons/contractIconRed.svg" alt="Contrato"> Contrato</label>
        <input id="contrato" formControlName="contrato" placeholder="Contrato">
      </div>
      <div class="form-group">
        <label for="ordemInicioServico"><img src="img/redIcons/contractIconRed.svg" alt="Ordem de Início de Serviço"> Ordem de Início de Serviço</label>
        <input id="ordemInicioServico" formControlName="ordemInicioServico" placeholder="Ordem de Início de Serviço">
      </div>
      <div class="form-group">
        <label for="coordenadorNome"><img src="img/redIcons/coordinatorIconRed.svg" alt="Coordenador"> Nome do Coordenador</label>
        <input id="coordenadorNome" formControlName="coordenadorNome" placeholder="Nome do Coordenador">
      </div>
      <div class="form-group">
        <label for="administradorNome"><img src="img/redIcons/admIconRed.svg" alt="Administrador"> Nome do Administrador</label>
        <input id="administradorNome" formControlName="administradorNome" placeholder="Nome do Administrador">
      </div>
      <div class="form-group">
        <label for="responsavelTecnicoNome"><img src="img/redIcons/engineerIconRed.svg" alt="Responsável Técnico"> Nome do Responsável Técnico</label>
        <input id="responsavelTecnicoNome" formControlName="responsavelTecnicoNome" placeholder="Nome do Responsável Técnico">
      </div>
      <div class="form-group">
        <label for="equipe"><img src="img/redIcons/teamIconRed.svg" alt="Equipe"> Equipe</label>
        <input id="equipe" formControlName="equipe" placeholder="Equipe">
      </div>
      <div class="form-group">
        <label for="dataInicio"><img src="img/redIcons/calendarIconRed.svg" alt="Data de Início"> Data de Início</label>
        <input id="dataInicio" type="date" formControlName="dataInicio">
      </div>
      <div class="form-group">
        <label for="dataTermino"><img src="img/redIcons/calendarIconRed.svg" alt="Data de Término"> Data de Término</label>
        <input id="dataTermino" type="date" formControlName="dataTermino">
      </div>
      <div class="form-group">
        <label for="observacoes"><img src="img/redIcons/clipboardIconRed.svg" alt="Observações"> Observações</label>
        <textarea id="observacoes" formControlName="observacoes" placeholder="Observações"></textarea>
      </div>
      <div class="form-group">
        <label for="status"><img src="img/redIcons/statusIconRed.svg" alt="Status"> Status</label>
        <select id="status" formControlName="status">
          <option *ngFor="let status of statuses" [value]="status.value">
            {{ status.name }}
          </option>
        </select>
      </div>
      <div class="form-actions">
        <button type="button" (click)="goBack()" class="btn btn-secondary">Voltar</button>
        <button type="submit" [disabled]="!obraForm.valid || loading" class="btn btn-primary">
          <span *ngIf="loading" class="spinner"></span>
          <img *ngIf="!loading" src="img/saveIcon.svg" alt="Save Icon" class="button-icon">
          {{ loading ? 'Salvando...' : 'Salvar' }}
        </button>
      </div>
    </form>
  </div>
</div>

<ng-template #noPermission>
  <div class="permission-denied">
    <h2>Acesso Negado</h2>
    <p>Você não tem permissão para criar novas obras.</p>
    <button type="button" (click)="goBack()" class="btn btn-secondary">Voltar</button>
  </div>
</ng-template>
